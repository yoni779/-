<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CEO Simulator âˆ (Auto)</title>
    <style>
        :root {
            --bg: #0f172a;
            --card: #1e293b;
            --text: #f1f5f9;
            --accent: #38bdf8;
            --finance: #4ade80;
            --marketing: #f472b6;
            --ops: #fbbf24;
            --hr: #a78bfa;
            --danger: #ef4444;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding-bottom: 80px;
        }

        /* ×“××©×‘×•×¨×“ ×¢×œ×™×•×Ÿ */
        header {
            background: #020617;
            padding: 15px 20px;
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid #334155;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .level-badge {
            background: var(--accent);
            color: #0f172a;
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .money-badge {
            color: var(--finance);
            font-weight: bold;
            font-size: 1.1rem;
        }

        /* ×¨×©×ª ×”×§×˜×’×•×¨×™×•×ª */
        .grid-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            padding: 20px;
        }

        .category-card {
            background: var(--card);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: 0.2s;
            border: 2px solid transparent;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 120px;
        }

        .category-card:hover { transform: scale(1.02); }
        
        .cat-icon { font-size: 2.5rem; margin-bottom: 10px; }
        .cat-title { font-weight: bold; font-size: 1rem; }
        .progress-mini { font-size: 0.8rem; color: #94a3b8; margin-top: 5px; }

        .c-finance { border-color: var(--finance); box-shadow: 0 0 15px rgba(74, 222, 128, 0.1); }
        .c-marketing { border-color: var(--marketing); box-shadow: 0 0 15px rgba(244, 114, 182, 0.1); }
        .c-ops { border-color: var(--ops); box-shadow: 0 0 15px rgba(251, 191, 36, 0.1); }
        .c-hr { border-color: var(--hr); box-shadow: 0 0 15px rgba(167, 139, 250, 0.1); }

        /* ××–×•×¨ ×”×œ××™×“×” */
        .active-area {
            background: var(--card);
            margin: 20px;
            padding: 25px;
            border-radius: 20px;
            border: 1px solid #334155;
            display: none;
            animation: slideUp 0.3s;
        }

        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        .lesson-tag {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.8rem;
            margin-bottom: 15px;
            background: #334155;
        }

        h2 { margin-top: 0; color: var(--accent); }
        .content-text { line-height: 1.6; font-size: 1.1rem; color: #cbd5e1; margin-bottom: 25px; }

        .btn-option {
            width: 100%;
            padding: 15px;
            margin-bottom: 10px;
            background: #0f172a;
            border: 1px solid #475569;
            color: white;
            border-radius: 10px;
            text-align: right;
            cursor: pointer;
            font-size: 1rem;
            transition: 0.2s;
            box-sizing: border-box;
        }

        .btn-option:hover { background: #1e293b; border-color: var(--accent); }

        /* ×”×ª×¨××•×ª */
        .feedback {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            display: none;
            font-weight: bold;
            text-align: center;
        }
        .f-good { background: rgba(74, 222, 128, 0.2); color: var(--finance); border: 1px solid var(--finance); }
        .f-bad { background: rgba(239, 68, 68, 0.2); color: var(--danger); border: 1px solid var(--danger); }

        .infinite-btn {
            display: block;
            width: 90%;
            margin: 30px auto;
            padding: 20px;
            background: linear-gradient(45deg, #6366f1, #8b5cf6);
            border: none;
            border-radius: 15px;
            color: white;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 10px 25px rgba(99, 102, 241, 0.3);
            animation: pulse 2s infinite;
        }

        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.02); } 100% { transform: scale(1); } }

    </style>
</head>
<body>

    <header>
        <div>
            <div style="font-size:0.8rem; color:#94a3b8;">×“×¨×’×” × ×•×›×—×™×ª</div>
            <div class="level-badge" id="rankDisplay">×× ×›"×œ ××ª×—×™×œ</div>
        </div>
        <div class="money-badge" id="moneyDisplay">$10,000</div>
    </header>

    <div style="padding: 20px 20px 0 20px;">
        <h3>×‘×—×¨ ××—×œ×§×” ×œ× ×™×”×•×œ:</h3>
    </div>

    <div class="grid-container">
        <div class="category-card c-finance" onclick="openCategory('finance')">
            <div class="cat-icon">ğŸ’°</div>
            <div class="cat-title">× ×™×”×•×œ ×¤×™× × ×¡×™</div>
            <div class="progress-mini" id="prog-finance">×©×™×¢×•×¨ 1</div>
        </div>
        <div class="category-card c-marketing" onclick="openCategory('marketing')">
            <div class="cat-icon">ğŸ“¢</div>
            <div class="cat-title">×©×™×•×•×§ ×•××›×™×¨×•×ª</div>
            <div class="progress-mini" id="prog-marketing">×©×™×¢×•×¨ 1</div>
        </div>
        <div class="category-card c-ops" onclick="openCategory('ops')">
            <div class="cat-icon">ğŸ­</div>
            <div class="cat-title">×ª×¤×¢×•×œ ×•××—×–×§×”</div>
            <div class="progress-mini" id="prog-ops">×©×™×¢×•×¨ 1</div>
        </div>
        <div class="category-card c-hr" onclick="openCategory('hr')">
            <div class="cat-icon">ğŸ‘¥</div>
            <div class="cat-title">× ×™×”×•×œ ×¢×•×‘×“×™×</div>
            <div class="progress-mini" id="prog-hr">×©×™×¢×•×¨ 1</div>
        </div>
    </div>

    <div class="active-area" id="lessonArea">
        <div class="lesson-tag" id="lessonTag">×§×˜×’×•×¨×™×”</div>
        <h2 id="lessonTitle">×›×•×ª×¨×ª</h2>
        <div class="content-text" id="lessonContent">×ª×•×›×Ÿ...</div>
        <div id="optionsArea"></div>
        <div class="feedback" id="feedbackArea"></div>
        <button id="nextBtn" style="display:none; width:100%; padding:15px; background:var(--accent); border:none; color:black; font-weight:bold; border-radius:10px; margin-top:15px; cursor:pointer;" onclick="closeLesson()">×¡×’×•×¨</button>
    </div>

    <button class="infinite-btn" onclick="generateRandomEvent()">ğŸ² ××ª×’×¨ ×¢×¡×§×™ (××™× ×¡×•×¤×™)</button>
    
    <div style="text-align:center; margin-bottom:20px;">
        <button onclick="resetGame()" style="background:none; border:1px solid #555; color:#777; padding:5px 10px; border-radius:5px; cursor:pointer;">××™×¤×•×¡ ××©×—×§</button>
    </div>

    <script>
        // --- ××¡×“ × ×ª×•× ×™×: ×©×™×¢×•×¨×™× ××•×‘× ×™× ---
        const DATABASE = {
            finance: [
                { t: "×ª×–×¨×™× ××–×•×× ×™×", c: "×”×”×‘×“×œ ×‘×™×Ÿ ×¨×•×•×— ×œ×›×¡×£ ×‘×‘× ×§ ×”×•× ×§×¨×™×˜×™. ×¨×•×•×— ×”×•× ×ª×™××•×¨×˜×™ (×—×©×‘×•× ×™×ª ×©×™×¦××”), ×ª×–×¨×™× ×”×•× ×”×›×¡×£ ×©× ×›× ×¡ ×‘×¤×•×¢×œ. ×× ×™×© ×œ×š ×”×•×¦××•×ª ×”×™×•× ××‘×œ ×”×›×¡×£ × ×›× ×¡ ×¢×•×“ 60 ×™×•×, ××ª×” ×‘×‘×¢×™×”.", q: "××” ×”×¤×ª×¨×•×Ÿ ×œ×‘×¢×™×™×ª ×ª×–×¨×™×?", o: ["×œ×§×—×ª ×”×œ×•×•××•×ª ×œ×œ× ×›×™×¡×•×™", "×œ×‘×§×© ××§×“××•×ª ××œ×§×•×—×•×ª ×•×“×—×™×™×ª ×ª×©×œ×•× ×œ×¡×¤×§×™×", "×œ×”×ª×¢×œ×"], a: 1 },
                { t: "×“×•×— ×¨×•×•×— ×•×”×¤×¡×“ (P&L)", c: "×× ×›\"×œ ×—×™×™×‘ ×œ×“×¢×ª ×œ×§×¨×•× ×“×•×— ×¨×•×•×— ×•×”×¤×¡×“. ×”×”×›× ×¡×•×ª ×œ××¢×œ×”, ×”×”×•×¦××•×ª ×‘×××¦×¢, ×”×¨×•×•×— ×œ××˜×”. ×©×™× ×œ×‘ ×œ×”×•×¦××•×ª ×§×‘×•×¢×•×ª (×©×›×™×¨×•×ª) ××•×œ ××©×ª× ×•×ª (×—×•××¨ ×’×œ×).", q: "××”×™ ×”×•×¦××” ×§×‘×•×¢×”?", o: ["×§× ×™×™×ª ×¡×—×•×¨×”", "×©×›×¨ ×“×™×¨×” ×•××¨× ×•× ×”", "×‘×•× ×•×¡ ×œ×¢×•×‘×“ ××¦×˜×™×™×Ÿ"], a: 1 },
                { t: "ROI (×”×—×–×¨ ×”×©×§×¢×”)", c: "×œ×¤× ×™ ×›×œ ×”×•×¦××” ×ª×©××œ: ××” ×”-ROI? ×× ×”×©×§×¢×ª 100 ×©×§×œ ×‘×¤×¨×¡×•× ×•×”×›× ×¡×ª 150, ×”-ROI ×”×•× ×—×™×•×‘×™. ×× ×”×©×§×¢×ª ×‘××›×•× ×” ×—×“×©×” ×•×”×™× ×—×•×¡×›×ª ×œ×š ×–××Ÿ ×¢×‘×•×“×”, ×–×” ×’× ROI.", q: "××ª×™ ×›×“××™ ×œ×”×©×§×™×¢?", o: ["×›×©×”×”×—×–×¨ ×”×¦×¤×•×™ ×’×‘×•×” ××”×¢×œ×•×ª", "×›×©×‘× ×œ×™ ×œ×”×ª×—×“×©", "×›×©×›×•×œ× ××©×§×™×¢×™×"], a: 0 }
            ],
            marketing: [
                { t: "××™ ×§×”×œ ×”×™×¢×“?", c: "××œ ×ª××›×•×¨ ×œ×›×•×œ×. ×ª××›×•×¨ ×œ××™ ×©×¦×¨×™×š ××•×ª×š. ×ª×’×“×™×¨: ×’×™×œ, ××™×§×•×, ×ª×—×•××™ ×¢× ×™×™×Ÿ. ×›×›×œ ×©×ª×”×™×” ×××•×§×“ ×™×•×ª×¨, ×”×©×™×•×•×§ ×™×¢×œ×” ×¤×—×•×ª ×•×™×›× ×™×¡ ×™×•×ª×¨.", q: "×œ××” ×œ×¤×œ×— ×©×•×§?", o: ["×›×“×™ ×œ×”×’×™×¢ ×œ×× ×©×™× ×”×¨×œ×•×•× ×˜×™×™× ×‘×™×•×ª×¨", "×›×“×™ ×œ×”×¤×¡×™×“ ×œ×§×•×—×•×ª", "×–×” ×œ× ×—×©×•×‘"], a: 0 },
                { t: "LTV (×¢×¨×š ×—×™×™ ×œ×§×•×—)", c: "×œ×§×•×— ×”×•× ×œ× ×¢×¡×§×” ×—×“ ×¤×¢××™×ª. ×”××˜×¨×” ×”×™× ×©×”×•× ×™×—×–×•×¨ ×©×•×‘ ×•×©×•×‘. ×œ×§×•×— ×©×§× ×” ×‘-50 ×©×§×œ ××‘×œ ×—×•×–×¨ ×›×œ ×—×•×“×© ×‘××©×š ×©× ×”, ×©×•×•×” ×œ×š 600 ×©×§×œ.", q: "××™×š ××’×“×™×œ×™× LTV?", o: ["××¢×œ×™× ××—×™×¨ ×‘×œ×™ ×œ×”×•×“×™×¢", "×©×•××¨×™× ×¢×œ ×§×©×¨ ×•×©×™×¨×•×ª ××¢×•×œ×” ×œ××•×¨×š ×–××Ÿ", "××ª×¢×œ××™× ××× ×• ××—×¨×™ ×”×§× ×™×™×”"], a: 1 }
            ],
            ops: [
                { t: "× ×™×”×•×œ ××œ××™", c: "××œ××™ ×–×” ×›×¡×£ ×©×™×•×©×‘ ×¢×œ ×”××“×£. ×™×•×ª×¨ ××“×™ ××œ××™? ×”×›×¡×£ ×ª×§×•×¢. ×¤×—×•×ª ××“×™? ××ª×” ××¤×¡×¤×¡ ××›×™×¨×•×ª. ×”×—×•×›××” ×”×™× ×œ××¦×•× ××ª ×”××™×–×•×Ÿ (Just in Time).", q: "××” ×”×¡×›× ×” ×‘××œ××™ ×¢×•×“×£?", o: ["×©×”××“×¤×™× ×™×¨××• ××œ××™×", "×‘×œ××™, ×’× ×™×‘×•×ª ×•×›×¡×£ ×ª×§×•×¢", "××™×Ÿ ×¡×›× ×”"], a: 1 },
                { t: "××—×–×§×” ××•× ×¢×ª", c: "××œ ×ª×—×›×” ×©×”××–×’×Ÿ ×™×ª×¤×•×¦×¥ ×‘×™×•× ×”×›×™ ×—×. ××—×–×§×” ××•× ×¢×ª ×¢×•×œ×” ×›×¡×£ ×¢×›×©×™×•, ××‘×œ ×—×•×¡×›×ª ×”×•×Ÿ ××—×¨ ×›×š ×¢×œ ×”×©×‘×ª×ª ×”×¢×¡×§ ×•×ª×™×§×•× ×™ ×—×™×¨×•×.", q: "××”×™ ×’×™×©×ª ××—×–×§×” ××•× ×¢×ª?", o: ["×œ×ª×§×Ÿ ×¨×§ ×›×©× ×©×‘×¨", "×œ×‘×¦×¢ ×‘×“×™×§×•×ª ×ª×§×•×¤×ª×™×•×ª ×›×“×™ ×œ×× ×•×¢ ×ª×§×œ×•×ª", "×œ×§× ×•×ª ×ª××™×“ ×—×“×©"], a: 1 }
            ],
            hr: [
                { t: "×’×™×•×¡ ×¢×•×‘×“×™×", c: "××œ ×ª×’×™×™×¡ ××ª ××™ ×©×”×›×™ ×–×•×œ, ×ª×’×™×™×¡ ××ª ××™ ×©×”×›×™ ××ª××™×. ×¢×•×‘×“ ×’×¨×•×¢ ×¢×•×œ×” ×œ×š ×‘× ×–×§×™×, ×–××Ÿ × ×™×”×•×œ ×•×¢×•×’××ª × ×¤×© ×™×•×ª×¨ ××”××©×›×•×¨×ª ×©×œ×•.", q: "××” ×—×©×•×‘ ×‘×¨××™×•×Ÿ?", o: ["×¨×§ ×”×©×›×¨ ×©×”×•× ××‘×§×©", "×”×™×›×•×œ×ª, ×”××•×¤×™ ×•×”×”×ª×××” ×œ×¦×•×•×ª", "××™×¤×” ×”×•× ×’×¨"], a: 1 },
                { t: "×”××¦×œ×ª ×¡××›×•×™×•×ª", c: "××ª×” ×œ× ×™×›×•×œ ×œ×¢×©×•×ª ×”×›×œ. ×× ××ª×” ×¢×•×©×” ×¢×‘×•×“×” ×©×œ ×¢×•×‘×“ ×–×•×˜×¨, ××ª×” ××¤×¡×™×“ ×›×¡×£ ×›×× ×›\"×œ. ×ª×œ××“ ×œ×¡××•×š, ×œ×ª×ª ××©×™××•×ª ×•×œ×‘×“×•×§ ×‘×™×¦×•×¢×™×.", q: "×œ××” ×× ×”×œ×™× ×—×•×©×©×™× ×œ×”××¦×™×œ?", o: ["×¤×—×“ ×©×”×¢×•×‘×“ ×™×¢×©×” ×˜×¢×•×ª", "×›×™ ××™×Ÿ ×œ×”× ×¢×‘×•×“×”", "×›×™ ×”× ×¢×¦×œ× ×™×"], a: 0 }
            ]
        };

        // --- ××—×•×œ×œ ×”××™×¨×•×¢×™× ×”××™× ×¡×•×¤×™ ---
        const EVENTS_TEMPLATES = [
            { text: "×¦×™× ×•×¨ ××™× ×”×ª×¤×•×¦×¥ ×‘×—× ×•×ª ×‘×××¦×¢ ×”×™×•×!", opts: ["×¡×’×•×¨ ××ª ×”×—× ×•×ª ×•×ª×§×Ÿ ×œ×‘×“ (×”×¤×¡×“ ×”×›× ×¡×”)", "×”×–××Ÿ ××™× ×¡×˜×œ×˜×•×¨ ×—×™×¨×•× ($500)", "×©×™× ×“×œ×™ ×•×ª××©×™×š ×›×¨×’×™×œ"], outcomes: [-1000, -500, -2000] },
            { text: "×œ×§×•×— ×›×•×¢×¡ ×××™×™× ×‘×ª×‘×™×¢×” ×‘×’×œ×œ ××•×¦×¨ ×¤×’×•×.", opts: ["×”×¦×¢ ×œ×• ×¤×™×¦×•×™ ××œ× ×•××ª× ×” ($100)", "×”×ª×¢×œ× ××× ×•", "×ª××©×™× ××ª ×—×‘×¨×ª ×”××©×œ×•×—×™×"], outcomes: [-100, -1000, -500] },
            { text: "×”××ª×—×¨×” ×”×•×¨×™×“ ××—×™×¨×™× ×‘-20%. ××” ×ª×¢×©×”?", opts: ["×”×•×¨×“ ××—×™×¨×™× ×’× ××ª×” (×¤×’×™×¢×” ×‘×¨×•×•×—)", "×¦× ×‘×§××¤×™×™×Ÿ ×¢×œ ××™×›×•×ª ×”××•×¦×¨ ($300)", "××œ ×ª×¢×©×” ×›×œ×•×"], outcomes: [-500, -300, -100] },
            { text: "×¢×•×‘×“ ××¨×›×–×™ ××‘×§×© ×”×¢×œ××” ××• ×©×”×•× ×¢×•×–×‘.", opts: ["×ª×Ÿ ×œ×• ×”×¢×œ××” ($200 ×‘×—×•×“×©)", "×ª×Ÿ ×œ×• ×œ×œ×›×ª ×•×ª×’×™×™×¡ ×—×“×©", "×”×¦×¢ ×‘×•× ×•×¡ ×—×“ ×¤×¢××™ ($500)"], outcomes: [-200, -1000, -500] },
            { text: "×™×© ×œ×š ×¢×•×“×£ ××–×•×× ×™× ×©×œ $5,000. ××” ×ª×¢×©×”?", opts: ["×”×©××¨ ×‘×‘× ×§ ×œ×™×•× ×©×—×•×¨", "×”×©×§×¢ ×‘×©×™×¤×•×¥ ×”×¢×¡×§", "×—×œ×§ ×“×™×‘×™×“× ×“ (×§×— ×œ×›×™×¡)"], outcomes: [0, 1000, 5000] }
        ];

        // --- ××©×ª× ×™ ××¢×¨×›×ª ---
        let player = {
            money: 10000,
            rank: "×× ×›\"×œ ××ª×—×™×œ",
            progress: { finance: 0, marketing: 0, ops: 0, hr: 0 }
        };

        // ×œ××¢×‘×¨ ××•×˜×•××˜×™
        let autoNextTimeout = null;

        // ×˜×¢×™× ×” ××©××™×¨×”
        if (localStorage.getItem('ceoSimSave')) {
            player = JSON.parse(localStorage.getItem('ceoSimSave'));
        }
        updateUI();

        function updateUI() {
            document.getElementById('moneyDisplay').innerText = "$" + player.money.toLocaleString();
            document.getElementById('rankDisplay').innerText = getRankName();

            document.getElementById('prog-finance').innerText = "×©×™×¢×•×¨ " + (player.progress.finance + 1);
            document.getElementById('prog-marketing').innerText = "×©×™×¢×•×¨ " + (player.progress.marketing + 1);
            document.getElementById('prog-ops').innerText = "×©×™×¢×•×¨ " + (player.progress.ops + 1);
            document.getElementById('prog-hr').innerText = "×©×™×¢×•×¨ " + (player.progress.hr + 1);
        }

        function getRankName() {
            let total = player.progress.finance + player.progress.marketing + player.progress.ops + player.progress.hr;
            if (total > 20) return "×× ×›\"×œ ××™××¤×¨×™×”";
            if (total > 10) return "×¡×× ×›\"×œ";
            if (total > 5) return "×× ×”×œ ×× ×•×¡×”";
            return "×× ×›\"×œ ××ª×—×™×œ";
        }

        function clearAutoNext() {
            if (autoNextTimeout) {
                clearTimeout(autoNextTimeout);
                autoNextTimeout = null;
            }
        }

        function openCategory(cat) {
            clearAutoNext();
            const idx = player.progress[cat];
            // ×× × ×’××¨×• ×”×©×™×¢×•×¨×™× ×‘×§×˜×’×•×¨×™×” â€“ ×§×•×¤×¦×™× ×™×©×¨ ×œ×¡×™××•×œ×¦×™×•×ª
            if (!DATABASE[cat][idx]) {
                generateRandomEvent(cat);
                return;
            }
            const lesson = DATABASE[cat][idx];
            showLessonUI(cat, lesson.t, lesson.c, lesson.q, lesson.o, lesson.a);
        }

        function generateRandomEvent(forcedCat = null) {
            clearAutoNext();
            const template = EVENTS_TEMPLATES[Math.floor(Math.random() * EVENTS_TEMPLATES.length)];
            const uiCat = forcedCat ? forcedCat : "general";
            showEventUI(uiCat, "ğŸ”¥ ××™×¨×•×¢ ×‘×–××Ÿ ×××ª!", template.text, template.opts, template.outcomes, forcedCat);
        }

        function showLessonUI(cat, title, content, q, opts, correctIdx) {
            const area = document.getElementById('lessonArea');
            area.style.display = 'block';
            document.getElementById('lessonTag').innerText = getCatHebrew(cat);
            document.getElementById('lessonTag').style.backgroundColor = getCatColor(cat);
            document.getElementById('lessonTitle').innerText = title;
            document.getElementById('lessonContent').innerText = content;

            const feedback = document.getElementById('feedbackArea');
            feedback.style.display = 'none';
            
            const nextBtn = document.getElementById('nextBtn');
            nextBtn.style.display = 'none';

            const optsDiv = document.getElementById('optionsArea');
            optsDiv.innerHTML = "<p style=\"font-weight:bold;\">" + q + "</p>";

            opts.forEach((opt, i) => {
                const btn = document.createElement('div');
                btn.className = 'btn-option';
                btn.innerText = opt;
                btn.onclick = () => checkLessonAnswer(cat, i, correctIdx);
                optsDiv.appendChild(btn);
            });
            area.scrollIntoView({ behavior: "smooth" });
        }

        function checkLessonAnswer(cat, selected, correct) {
            const feedback = document.getElementById('feedbackArea');
            feedback.style.display = 'block';

            if (selected === correct) {
                feedback.className = 'feedback f-good';
                feedback.innerText = "× ×›×•×Ÿ ×××•×“! +$500";
                player.money += 500;
                player.progress[cat]++;
                localStorage.setItem('ceoSimSave', JSON.stringify(player));
                updateUI();
                document.getElementById('optionsArea').innerHTML = "";

                // ××¢×‘×¨ ××•×˜×•××˜×™ ××—×¨×™ 3 ×©× ×™×•×ª
                autoNextTimeout = setTimeout(function () {
                    const idx = player.progress[cat];
                    if (DATABASE[cat][idx]) {
                        openCategory(cat);
                    } else {
                        generateRandomEvent(cat);
                    }
                }, 3000);
            } else {
                feedback.className = 'feedback f-bad';
                feedback.innerText = "×˜×¢×•×ª. × ×¡×” ×©×•×‘.";
            }
        }

        function showEventUI(cat, title, content, opts, outcomes, forcedCat) {
            const area = document.getElementById('lessonArea');
            area.style.display = 'block';
            document.getElementById('lessonTag').innerText = "×¡×™××•×œ×¦×™×”";
            document.getElementById('lessonTag').style.background = "linear-gradient(45deg, #6366f1, #8b5cf6)";
            document.getElementById('lessonTitle').innerText = title;
            document.getElementById('lessonContent').innerText = content;

            const feedback = document.getElementById('feedbackArea');
            feedback.style.display = 'none';
            const nextBtn = document.getElementById('nextBtn');
            nextBtn.style.display = 'none';

            const optsDiv = document.getElementById('optionsArea');
            optsDiv.innerHTML = "";

            opts.forEach((opt, i) => {
                const btn = document.createElement('div');
                btn.className = 'btn-option';
                btn.innerText = opt;
                btn.onclick = () => resolveEvent(outcomes[i], forcedCat || null);
                optsDiv.appendChild(btn);
            });
            area.scrollIntoView({ behavior: "smooth" });
        }

        function resolveEvent(outcomeMoney, forcedCat) {
            clearAutoNext();
            const feedback = document.getElementById('feedbackArea');
            document.getElementById('optionsArea').innerHTML = "";
            feedback.style.display = 'block';

            player.money += outcomeMoney;
            localStorage.setItem('ceoSimSave', JSON.stringify(player));
            updateUI();

            if (outcomeMoney > 0) {
                feedback.className = 'feedback f-good';
                feedback.innerText = "×”×—×œ×˜×” ×˜×•×‘×”! ×”×¨×•×•×—×ª $" + outcomeMoney;
            } else if (outcomeMoney < 0) {
                feedback.className = 'feedback f-bad';
                feedback.innerText = "×”×—×œ×˜×” ×›×•××‘×ª... ×”×¤×¡×“×ª $" + Math.abs(outcomeMoney);
            } else {
                feedback.className = 'feedback';
                feedback.style.border = '1px solid #ccc';
                feedback.innerText = "×”×—×œ×˜×” × ×™×™×˜×¨×œ×™×ª. ×”××¦×‘ × ×©××¨ ×™×¦×™×‘.";
            }

            // ××¢×‘×¨ ××•×˜×•××˜×™ ××—×¨×™ 3 ×©× ×™×•×ª
            autoNextTimeout = setTimeout(function () {
                generateRandomEvent(forcedCat || null);
            }, 3000);
        }

        function closeLesson() {
            clearAutoNext();
            document.getElementById('lessonArea').style.display = 'none';
        }

        function resetGame() {
            if(confirm('×œ××¤×¡ ×”×›×œ?')) {
                localStorage.removeItem('ceoSimSave');
                location.reload();
            }
        }

        function getCatHebrew(cat) {
            if (cat == 'finance') return '×¤×™× × ×¡×™';
            if (cat == 'marketing') return '×©×™×•×•×§';
            if (cat == 'ops') return '×ª×¤×¢×•×œ';
            if (cat == 'hr') return '××©××‘×™ ×× ×•×©';
            return '×›×œ×œ×™';
        }

        function getCatColor(cat) {
            if (cat == 'finance') return 'var(--finance)';
            if (cat == 'marketing') return 'var(--marketing)';
            if (cat == 'ops') return 'var(--ops)';
            if (cat == 'hr') return 'var(--hr)';
            return '#ccc';
        }
    </script>
</body>
</html>
