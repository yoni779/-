<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Daylight Racer Fixed â˜€ï¸</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #87CEEB; /* ×©××™×™× ×›×—×•×œ×™× */
            font-family: 'Arial', sans-serif;
            touch-action: none;
        }

        #gameContainer {
            position: relative;
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            overflow: hidden;
        }

        /* ×”×›×‘×™×© */
        #road {
            position: relative;
            width: 100%;
            max-width: 600px;
            height: 100%;
            background-color: #dcdde1; /* ××¤×•×¨ ×‘×”×™×¨ */
            border-left: 10px solid #44bd32; /* ×“×©× */
            border-right: 10px solid #44bd32;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        /* ×”×©×—×§×Ÿ */
        #player {
            position: absolute;
            bottom: 30px;
            width: 60px;
            height: 90px;
            background: #e84118; /* ××“×•× ×‘×•×”×§ */
            border-radius: 10px;
            border: 3px solid #c23616;
            left: 50%;
            transform: translateX(-50%);
            transition: left 0.08s ease-out;
            z-index: 10;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }

        #player::after {
            content: '×× ×™';
            color: white;
            font-weight: bold;
            font-size: 1.2rem;
        }

        /* ××›×©×•×œ×™× */
        .obstacle {
            position: absolute;
            width: 60px;
            height: 60px;
            background: #2f3640;
            border-radius: 8px;
            border: 2px solid black;
            z-index: 5;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-weight: bold;
        }
        .obstacle::before { content: 'âš ï¸'; font-size: 1.5rem; }

        /* ×¤×¡×™ ×”×¤×¨×“×” */
        .line {
            position: absolute;
            width: 6px;
            height: 60px;
            background-color: white;
            left: 50%;
            transform: translateX(-50%);
        }

        /* ×œ×•×— × ×™×§×•×“ */
        #scorePanel {
            position: absolute;
            top: 20px;
            left: 20px;
            background: white;
            padding: 10px 20px;
            border-radius: 15px;
            border: 3px solid #2f3640;
            color: black;
            font-size: 2rem;
            font-weight: 900;
            z-index: 50;
            box-shadow: 0 5px 0 rgba(0,0,0,0.2);
        }

        /* ××¡×š ×¤×ª×™×—×”/×¡×™×•× */
        #overlay {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255, 255, 255, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #2f3640;
            z-index: 100;
            text-align: center;
        }

        h1 { font-size: 3.5rem; margin: 0; color: #e84118; text-transform: uppercase; }

        button {
            background: #44bd32;
            border: none;
            padding: 20px 50px;
            color: white;
            font-size: 1.5rem;
            font-weight: bold;
            border-radius: 50px;
            margin-top: 30px;
            cursor: pointer;
            box-shadow: 0 5px 0 #218c14;
            transition: 0.1s;
        }
        button:active { transform: translateY(5px); box-shadow: none; }

        /* ×ª×™×§×•×Ÿ ×›×¤×ª×•×¨×™ ×”×©×œ×™×˜×” */
        .controls-area {
            display: flex;
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0; left: 0;
            z-index: 20;
        }
        
        .control-side {
            width: 50%;
            height: 100%;
        }
        
        .boom {
            background: black !important;
            transform: translateX(-50%) scale(1.2) !important;
            transition: 0.2s !important;
        }

    </style>
</head>
<body>

    <div id="gameContainer">
        <div id="scorePanel">0</div>
        
        <div id="road">
            <div id="player"></div>
        </div>

        <div class="controls-area">
            <div class="control-side" onclick="moveRight()"></div> <div class="control-side" onclick="moveLeft()"></div>  </div>
    </div>

    <div id="overlay">
        <h1>××™×¨×•×¥<br>×›×‘×™×©</h1>
        <p id="msg" style="font-size:1.5rem; margin: 10px 0;">×”×’×” ××ª×•×§×Ÿ! ××•×›×Ÿ?</p>
        <button onclick="startGame()">×”×ª×—×œ × ×¡×™×¢×” â–¶</button>
    </div>

    <script>
        const player = document.getElementById('player');
        const road = document.getElementById('road');
        const scoreDisplay = document.getElementById('scorePanel');
        const overlay = document.getElementById('overlay');
        
        let gameActive = false;
        let score = 0;
        let speed = 6;
        let playerLane = 1;
        let obstacles = [];
        let animationFrame;
        let spawnCounter = 0;
        const LANES_POS = [20, 50, 80]; 

        function moveLeft() {
            if(!gameActive) return;
            if(playerLane > 0) playerLane--;
            updatePlayerPos();
        }

        function moveRight() {
            if(!gameActive) return;
            if(playerLane < 2) playerLane++;
            updatePlayerPos();
        }

        function updatePlayerPos() {
            player.style.left = LANES_POS[playerLane] + '%';
        }

        function startGame() {
            overlay.style.display = 'none';
            gameActive = true;
            score = 0;
            speed = 7;
            scoreDisplay.innerText = score;
            playerLane = 1;
            updatePlayerPos();
            player.classList.remove('boom');

            document.querySelectorAll('.obstacle').forEach(e => e.remove());
            document.querySelectorAll('.line').forEach(e => e.remove());
            obstacles = [];
            
            loop();
        }

        function gameOver() {
            gameActive = false;
            cancelAnimationFrame(animationFrame);
            player.classList.add('boom');
            
            document.getElementById('msg').innerHTML = "×”×ª×¨×¡×§×ª! ğŸ’¥<br>× ×™×§×•×“ ×¡×•×¤×™: <b>" + score + "</b>";
            document.querySelector('button').innerText = "× ×¡×” ×©×•×‘ â†»";
            setTimeout(() => overlay.style.display = 'flex', 800);
        }

        function createObstacle() {
            const obs = document.createElement('div');
            obs.className = 'obstacle';
            const laneIdx = Math.floor(Math.random() * 3);
            obs.style.left = LANES_POS[laneIdx] + '%';
            obs.style.transform = 'translateX(-50%)';
            obs.style.top = '-100px';
            road.appendChild(obs);
            obstacles.push({ el: obs, top: -100, lane: laneIdx });
        }

        function createRoadLine() {
            const line = document.createElement('div');
            line.className = 'line';
            line.style.top = '-60px';
            road.appendChild(line);
            let lineTop = -60;
            const interval = setInterval(() => {
                if(!gameActive) { clearInterval(interval); line.remove(); return; }
                lineTop += speed;
                line.style.top = lineTop + 'px';
                if(lineTop > window.innerHeight) {
                    line.remove();
                    clearInterval(interval);
                }
            }, 20);
        }

        function loop() {
            if (!gameActive) return;
            spawnCounter++;

            if (spawnCounter % 50 === 0) {
                createObstacle();
                speed += 0.1;
            }
            if (spawnCounter % 15 === 0) {
                createRoadLine();
            }

            obstacles.forEach((ob, index) => {
                ob.top += speed;
                ob.el.style.top = ob.top + 'px';
                const carTopPercent = (window.innerHeight - 120);
                
                if (ob.top > carTopPercent && ob.top < carTopPercent + 90) {
                    if (ob.lane === playerLane) gameOver();
                }
                if (ob.top > window.innerHeight) {
                    ob.el.remove();
                    obstacles.splice(index, 1);
                    score++;
                    scoreDisplay.innerText = score;
                }
            });
            animationFrame = requestAnimationFrame(loop);
        }
    </script>
</body>
</html>
