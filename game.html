<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×”××¢×‘×“×” ×”×¡×•×“×™×ª âš—ï¸</title>
    <style>
        :root {
            --bg: #1a1a2e;
            --card-bg: #16213e;
            --highlight: #e94560;
        }

        body {
            background-color: var(--bg);
            color: white;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            text-align: center;
            margin: 0;
            padding: 20px;
            user-select: none;
            overflow-x: hidden;
        }

        h1 {
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(255,255,255,0.5);
        }

        /* ××–×•×¨ ×”×¢×¨×‘×•×‘ */
        .mixing-area {
            height: 150px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 30px;
            position: relative;
        }

        .slot {
            width: 80px;
            height: 80px;
            border: 2px dashed #555;
            border-radius: 50%;
            margin: 0 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2.5rem;
            background: rgba(0,0,0,0.3);
            transition: 0.3s;
        }

        .slot.active {
            border-color: white;
            box-shadow: 0 0 15px rgba(255,255,255,0.2);
        }

        .plus-sign { font-size: 2rem; color: #888; }

        /* ×¨×©×™××ª ×”×™×¡×•×“×•×ª */
        .inventory {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 15px;
            max-width: 600px;
            margin: 0 auto;
            padding: 10px;
        }

        .element {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 15px;
            cursor: pointer;
            transition: 0.2s;
            display: flex;
            flex-direction: column;
            align-items: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            border: 2px solid transparent;
        }

        .element:hover { transform: translateY(-5px); background: #1f2b4d; }
        .element:active { transform: scale(0.95); }
        
        .element.selected {
            border-color: var(--highlight);
            box-shadow: 0 0 15px var(--highlight);
        }

        .icon { font-size: 2rem; margin-bottom: 5px; }
        .name { font-size: 0.8rem; color: #ccc; }

        /* ×× ×™××¦×™×™×ª ×’×™×œ×•×™ */
        #discoveryModal {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        .new-item-glow {
            font-size: 5rem;
            filter: drop-shadow(0 0 30px gold);
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes popIn { from { transform: scale(0); } to { transform: scale(1); } }

        .reset-btn {
            margin-top: 50px;
            background: none;
            border: 1px solid #444;
            color: #666;
            padding: 8px 15px;
            border-radius: 20px;
        }
    </style>
</head>
<body>

    <h1>ğŸ§ª ×”××¢×‘×“×”</h1>
    <p style="color:#888; font-size:0.9rem;">××¦××ª <span id="count">4</span> ××ª×•×š 14 ×™×¡×•×“×•×ª</p>

    <div class="mixing-area">
        <div class="slot" id="slot1" onclick="clearSlot(1)"></div>
        <div class="plus-sign">+</div>
        <div class="slot" id="slot2" onclick="clearSlot(2)"></div>
    </div>

    <div class="inventory" id="inventoryGrid">
        </div>

    <div id="discoveryModal" onclick="closeModal()">
        <h2 style="color: gold; margin-bottom: 20px;">âœ¨ ×ª×’×œ×™×ª ×—×“×©×”! âœ¨</h2>
        <div id="newIcon" class="new-item-glow"></div>
        <h3 id="newName" style="margin-top: 20px; font-size: 1.5rem;"></h3>
        <p style="color: #aaa; margin-top: 30px;">(×œ×—×¥ ×›×“×™ ×œ×”××©×™×š)</p>
    </div>

    <button class="reset-btn" onclick="resetGame()">××™×¤×•×¡ ××©×—×§</button>

    <script>
        // --- ×”×’×“×¨×•×ª ×”××©×—×§ ---
        
        // ×”×™×¡×•×“×•×ª ×”×§×™×™××™× ×‘×”×ª×—×œ×”
        const STARTING_ELEMENTS = ['fire', 'water', 'earth', 'air'];

        // ×‘×¡×™×¡ ×”× ×ª×•× ×™× ×©×œ ×›×œ ×”×™×¡×•×“×•×ª
        const DB = {
            'fire': { icon: 'ğŸ”¥', name: '××©', color: '#ff4d4d' },
            'water': { icon: 'ğŸ’§', name: '××™×', color: '#4d94ff' },
            'earth': { icon: 'ğŸŒ±', name: '××“××”', color: '#8cd98c' },
            'air': { icon: 'ğŸ’¨', name: '××•×•×™×¨', color: '#e6e6e6' },
            
            // ×¨××” 2
            'steam': { icon: 'â˜ï¸', name: '×§×™×˜×•×¨', color: '#ddd' }, // ××© + ××™×
            'lava': { icon: 'ğŸŒ‹', name: '×œ×‘×”', color: '#ff8c1a' }, // ××© + ××“××”
            'dust': { icon: 'ğŸŒ«ï¸', name: '××‘×§', color: '#bfbfbf' }, // ××•×•×™×¨ + ××“××”
            'rain': { icon: 'ğŸŒ§ï¸', name: '×’×©×', color: '#6666ff' }, // ××•×•×™×¨ + ××™×
            'energy': { icon: 'âš¡', name: '×× ×¨×’×™×”', color: '#ffff66' }, // ××© + ××•×•×™×¨
            'mud': { icon: 'ğŸ’©', name: '×‘×•×¥', color: '#663300' }, // ××™× + ××“××”

            // ×¨××” 3 (×“×•×’×××•×ª)
            'stone': { icon: 'ğŸª¨', name: '××‘×Ÿ', color: '#888' }, // ×œ×‘×” + ××™×
            'plant': { icon: 'ğŸŒ»', name: '×¦××—', color: '#00cc00' }, // ×’×©× + ××“××”
            'storm': { icon: 'â›ˆï¸', name: '×¡×•×¤×”', color: '#333' }, // ×× ×¨×’×™×” + ×’×©×
            'life': { icon: 'ğŸ§¬', name: '×—×™×™×', color: '#ff00ff' } // ×‘×•×¥ + ×× ×¨×’×™×” (×”×›×™ ×§×©×”)
        };

        // ××ª×›×•× ×™× (×¡×“×¨ ×œ× ××©× ×”)
        const RECIPES = [
            { in: ['fire', 'water'], out: 'steam' },
            { in: ['fire', 'earth'], out: 'lava' },
            { in: ['air', 'earth'], out: 'dust' },
            { in: ['air', 'water'], out: 'rain' },
            { in: ['fire', 'air'], out: 'energy' },
            { in: ['water', 'earth'], out: 'mud' },
            
            { in: ['lava', 'water'], out: 'stone' },
            { in: ['rain', 'earth'], out: 'plant' },
            { in: ['energy', 'rain'], out: 'storm' },
            { in: ['mud', 'energy'], out: 'life' }
        ];

        // --- ×œ×•×’×™×§×” ---

        let myElements = [...STARTING_ELEMENTS];
        let selected = [null, null]; // ×©× ×™ ×”×¡×œ×•×˜×™×

        // ×˜×¢×™× ×”
        if(localStorage.getItem('alchemySave')) {
            myElements = JSON.parse(localStorage.getItem('alchemySave'));
        }

        renderInventory();

        function renderInventory() {
            const grid = document.getElementById('inventoryGrid');
            grid.innerHTML = '';
            document.getElementById('count').innerText = myElements.length;

            myElements.forEach(key => {
                const el = DB[key];
                const div = document.createElement('div');
                div.className = 'element';
                div.innerHTML = `<div class="icon">${el.icon}</div><div class="name">${el.name}</div>`;
                div.onclick = () => addToMix(key);
                grid.appendChild(div);
            });
        }

        function addToMix(key) {
            // ×× ×¡×œ×•×˜ 1 ×¨×™×§
            if (!selected[0]) {
                selected[0] = key;
                document.getElementById('slot1').innerHTML = DB[key].icon;
                document.getElementById('slot1').style.borderColor = DB[key].color;
            } 
            // ×× ×¡×œ×•×˜ 2 ×¨×™×§
            else if (!selected[1]) {
                selected[1] = key;
                document.getElementById('slot2').innerHTML = DB[key].icon;
                document.getElementById('slot2').style.borderColor = DB[key].color;
                
                // ×‘×“×™×§×ª ×©×™×œ×•×‘ (×“×™×œ×™×™ ×§×˜×Ÿ ×œ××¤×§×˜)
                setTimeout(checkMix, 300);
            }
        }

        function clearSlot(num) {
            selected[num-1] = null;
            const el = document.getElementById('slot'+num);
            el.innerHTML = '';
            el.style.borderColor = '#555';
        }

        function checkMix() {
            const [a, b] = selected;
            
            // ×—×™×¤×•×© ××ª×›×•×Ÿ
            const recipe = RECIPES.find(r => 
                (r.in[0] === a && r.in[1] === b) || 
                (r.in[0] === b && r.in[1] === a)
            );

            if (recipe) {
                // ×™×© ×”×ª×××”!
                if (!myElements.includes(recipe.out)) {
                    // ×™×¡×•×“ ×—×“×© ×œ×’××¨×™!
                    myElements.push(recipe.out);
                    saveGame();
                    showNewDiscovery(recipe.out);
                } else {
                    // ×›×‘×¨ ×™×© ×œ× ×• ××ª ×–×”
                    shakeSlots(); // ××¤×§×˜ "×›×‘×¨ ×™×© ×œ×š ××ª ×–×”"
                }
            } else {
                // ×©×™×œ×•×‘ × ×›×©×œ
                shakeSlots();
            }

            // ××™×¤×•×¡ ×”×¡×œ×•×˜×™× ××—×¨×™ ×¨×’×¢
            setTimeout(() => {
                clearSlot(1);
                clearSlot(2);
            }, 1000);
        }

        function showNewDiscovery(key) {
            const el = DB[key];
            document.getElementById('newIcon').innerHTML = el.icon;
            document.getElementById('newName').innerText = el.name;
            document.getElementById('discoveryModal').style.display = 'flex';
            renderInventory();
        }

        function closeModal() {
            document.getElementById('discoveryModal').style.display = 'none';
        }

        function shakeSlots() {
            const area = document.querySelector('.mixing-area');
            area.style.transform = "translateX(10px)";
            setTimeout(() => area.style.transform = "translateX(-10px)", 50);
            setTimeout(() => area.style.transform = "translateX(5px)", 100);
            setTimeout(() => area.style.transform = "translateX(0)", 150);
        }

        function saveGame() {
            localStorage.setItem('alchemySave', JSON.stringify(myElements));
        }

        function resetGame() {
            if(confirm('×‘×˜×•×—? ×–×” ×™××—×§ ××ª ×›×œ ×”×ª×’×œ×™×•×ª.')) {
                localStorage.removeItem('alchemySave');
                location.reload();
            }
        }

    </script>
</body>
</html>
