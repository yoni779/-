<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YoniOS - × ×™×”×•×œ ××™×©×™</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        [x-cloak] { display: none !important; }
        input { border: 1px solid #e5e7eb; padding: 2px 5px; borderRadius: 4px; width: 100%; }
        .edit-mode-border { border: 2px dashed #3b82f6; padding: 5px; border-radius: 8px; background: #eff6ff; }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 font-sans pb-24" x-data="app()" x-init="initData()">

    <nav class="bg-white border-b border-gray-200 p-4 sticky top-0 z-50 shadow-sm flex justify-between items-center">
        <div>
            <h1 x-show="!editMode" class="text-2xl font-black text-blue-600" x-text="settings.appName"></h1>
            <input x-show="editMode" x-model="settings.appName" class="text-xl font-bold border-blue-300">
        </div>
        
        <div class="flex items-center gap-3">
            <button @click="editMode = !editMode" 
                :class="editMode ? 'bg-yellow-400 text-black' : 'bg-gray-100 text-gray-600'"
                class="w-10 h-10 rounded-full flex items-center justify-center shadow-sm transition-all">
                <i class="fa-solid" :class="editMode ? 'fa-check' : 'fa-gear'"></i>
            </button>
        </div>
    </nav>

    <div class="bg-blue-600 text-white p-6 text-center shadow-md mb-4">
        <p class="text-sm opacity-80 mb-1">×”×™×ª×¨×” ×©×œ×š</p>
        <div class="flex justify-center items-center gap-2">
            <span class="text-4xl font-bold">ğŸ’</span>
            <span x-show="!editMode" class="text-4xl font-bold" x-text="coins"></span>
            <input x-show="editMode" type="number" x-model="coins" class="text-black text-center text-2xl w-32 p-2 rounded">
        </div>
        <p x-show="editMode" class="text-xs mt-2 text-yellow-300">* ×‘××¦×‘ ×¢×¨×™×›×” ××¤×©×¨ ×œ×©× ×•×ª ××ª ×”×›××•×ª ×™×“× ×™×ª</p>
    </div>

    <div class="flex justify-center gap-2 mb-6 px-4">
        <template x-for="tab in tabs">
            <button 
                @click="currentTab = tab.id"
                :class="currentTab === tab.id ? 'bg-blue-600 text-white shadow-lg transform scale-105' : 'bg-white text-gray-600 shadow-sm'"
                class="px-4 py-2 rounded-xl font-medium transition-all text-sm flex-1"
                x-text="tab.label">
            </button>
        </template>
    </div>

    <main class="px-4 max-w-md mx-auto">

        <div x-show="currentTab === 'tasks'" x-transition>
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold">××©×™××•×ª</h2>
                <button @click="addItem('tasks')" class="bg-green-500 text-white px-3 py-1 rounded-full text-sm shadow-sm">
                    <i class="fa-solid fa-plus"></i> ×”×•×¡×£
                </button>
            </div>

            <div class="space-y-3">
                <template x-for="(task, index) in tasks" :key="index">
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-100 flex flex-col gap-2 relative"
                         :class="editMode ? 'edit-mode-border' : ''">
                        
                        <button x-show="editMode" @click="deleteItem('tasks', index)" class="absolute top-2 left-2 text-red-500 bg-red-100 w-8 h-8 rounded-full">
                            <i class="fa-solid fa-trash"></i>
                        </button>

                        <div class="flex items-center justify-between w-full">
                            <div class="flex items-center gap-3 w-full">
                                <input x-show="!editMode" type="checkbox" x-model="task.completed" @change="checkTask(task)" class="w-6 h-6 rounded text-blue-600 !w-6">
                                
                                <span x-show="!editMode" :class="task.completed ? 'line-through text-gray-400' : 'font-medium'" x-text="task.title"></span>
                                <input x-show="editMode" x-model="task.title" placeholder="×©× ×”××©×™××”">
                            </div>
                            
                            <div class="bg-yellow-50 text-yellow-700 px-2 py-1 rounded-lg font-bold text-xs flex items-center gap-1 whitespace-nowrap">
                                <span>+</span>
                                <span x-show="!editMode" x-text="task.reward"></span>
                                <input x-show="editMode" type="number" x-model="task.reward" class="w-12 text-center text-xs p-0">
                            </div>
                        </div>
                    </div>
                </template>
            </div>
            <div x-show="tasks.length === 0" class="text-center text-gray-400 mt-10">××™×Ÿ ××©×™××•×ª. ×ª×ª×—×™×œ ×œ×¢×‘×•×“! ğŸ˜‰</div>
        </div>

        <div x-show="currentTab === 'shop'" x-transition x-cloak>
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold">×—× ×•×ª ×¤×™× ×•×§×™×</h2>
                <button @click="addItem('shop')" class="bg-green-500 text-white px-3 py-1 rounded-full text-sm shadow-sm">
                    <i class="fa-solid fa-plus"></i> ×”×•×¡×£
                </button>
            </div>

            <div class="grid grid-cols-1 gap-4">
                <template x-for="(item, index) in shopItems" :key="index">
                    <div class="bg-white p-4 rounded-xl shadow-sm flex flex-col relative" :class="editMode ? 'edit-mode-border' : ''">
                        
                        <button x-show="editMode" @click="deleteItem('shopItems', index)" class="absolute top-2 left-2 text-red-500 bg-red-100 w-8 h-8 rounded-full z-10">
                            <i class="fa-solid fa-trash"></i>
                        </button>

                        <div class="mb-3">
                            <h3 x-show="!editMode" class="font-bold text-lg" x-text="item.name"></h3>
                            <input x-show="editMode" x-model="item.name" class="font-bold mb-2" placeholder="×©× ×”×¤×™× ×•×§">
                        </div>

                        <button @click="buyItem(item)" 
                            :disabled="coins < item.cost && !editMode"
                            :class="coins >= item.cost ? 'bg-blue-600 text-white' : 'bg-gray-300 text-gray-500'"
                            class="w-full py-2 rounded-lg font-bold text-sm transition-colors flex justify-center items-center gap-2">
                            
                            <span x-show="!editMode">×¨×›×•×© ×‘-</span>
                            <span x-show="!editMode" x-text="item.cost"></span>
                            <input x-show="editMode" type="number" x-model="item.cost" class="w-16 text-black text-center">
                            <span>ğŸ’</span>
                        </button>
                    </div>
                </template>
            </div>
        </div>

        <div x-show="currentTab === 'habits'" x-transition x-cloak>
             <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold">×”×¨×’×œ×™× ×™×•××™×™×</h2>
                <button @click="addItem('habits')" class="bg-green-500 text-white px-3 py-1 rounded-full text-sm shadow-sm">
                    <i class="fa-solid fa-plus"></i> ×”×•×¡×£
                </button>
            </div>
            
             <div class="space-y-3">
                <template x-for="(habit, index) in habits" :key="index">
                    <div class="bg-white p-4 rounded-xl shadow-sm flex justify-between items-center" :class="editMode ? 'edit-mode-border' : ''">
                        
                         <div class="flex items-center gap-3 w-full">
                             <span x-show="!editMode" x-text="habit.name" class="font-medium"></span>
                             <input x-show="editMode" x-model="habit.name" placeholder="×©× ×”×”×¨×’×œ">
                         </div>

                         <div class="flex items-center gap-2">
                             <button x-show="!editMode" @click="toggleHabit(habit)" 
                                class="w-10 h-10 rounded-full flex items-center justify-center transition-colors shadow-sm"
                                :class="habit.done ? 'bg-green-500 text-white' : 'bg-gray-100 text-gray-400'">
                                <i class="fa-solid fa-check"></i>
                            </button>
                            <button x-show="editMode" @click="deleteItem('habits', index)" class="text-red-500 bg-red-100 w-8 h-8 rounded-full flex items-center justify-center">
                                <i class="fa-solid fa-trash"></i>
                            </button>
                         </div>
                    </div>
                </template>
            </div>
             <button @click="resetHabits()" class="mt-6 w-full py-3 bg-gray-200 text-gray-600 rounded-xl font-bold text-sm">××™×¤×•×¡ ×”×¨×’×œ×™× ×œ×™×•× ×—×“×© â˜€ï¸</button>
        </div>

    </main>

    <script>
        function app() {
            return {
                editMode: false,
                currentTab: 'tasks',
                coins: 0,
                settings: { appName: 'YoniOS' },
                tabs: [
                    { id: 'tasks', label: '××©×™××•×ª' },
                    { id: 'shop', label: '×—× ×•×ª' },
                    { id: 'habits', label: '×”×¨×’×œ×™×' },
                ],
                tasks: [],
                shopItems: [],
                habits: [],

                initData() {
                    // ×˜×¢×™× ×ª × ×ª×•× ×™× ××”×–×™×›×¨×•×Ÿ ×©×œ ×”×˜×œ×¤×•×Ÿ
                    const savedData = localStorage.getItem('yonios_data_v1');
                    if (savedData) {
                        const data = JSON.parse(savedData);
                        this.coins = data.coins;
                        this.tasks = data.tasks;
                        this.shopItems = data.shopItems;
                        this.habits = data.habits;
                        this.settings = data.settings || { appName: 'YoniOS' };
                    } else {
                        // × ×ª×•× ×™× ×”×ª×—×œ×ª×™×™× ×× ×–×• ×¤×¢× ×¨××©×•× ×”
                        this.coins = 100;
                        this.tasks = [{ title: '××©×™××” ×¨××©×•× ×” ×œ×“×•×’××”', reward: 50, completed: false }];
                        this.shopItems = [{ name: '×¤×™× ×•×§ ×œ×“×•×’××”', cost: 100 }];
                        this.habits = [{ name: '×œ×©×ª×•×ª ××™×', done: false }];
                    }

                    // ×©××™×¨×” ××•×˜×•××˜×™×ª ×‘×›×œ ×©×™× ×•×™
                    this.$watch('coins', () => this.save());
                    this.$watch('tasks', () => this.save());
                    this.$watch('shopItems', () => this.save());
                    this.$watch('habits', () => this.save());
                    this.$watch('settings', () => this.save());
                },

                save() {
                    const data = {
                        coins: parseInt(this.coins),
                        tasks: this.tasks,
                        shopItems: this.shopItems,
                        habits: this.habits,
                        settings: this.settings
                    };
                    localStorage.setItem('yonios_data_v1', JSON.stringify(data));
                },

                checkTask(task) {
                    if (task.completed) {
                        this.coins = parseInt(this.coins) + parseInt(task.reward);
                        // ××¤×§×˜ ×§×•×œ ×™×›×•×œ ×œ×”×™×•×ª ×›××Ÿ
                    } else {
                        this.coins = parseInt(this.coins) - parseInt(task.reward);
                    }
                },

                toggleHabit(habit) {
                    habit.done = !habit.done;
                    if(habit.done) this.coins = parseInt(this.coins) + 10;
                    else this.coins = parseInt(this.coins) - 10;
                },

                buyItem(item) {
                    if (this.coins >= item.cost) {
                        if(confirm('×œ×§× ×•×ª ××ª ' + item.name + '?')) {
                            this.coins -= item.cost;
                        }
                    }
                },

                addItem(type) {
                    if(type === 'tasks') this.tasks.push({ title: '××©×™××” ×—×“×©×”', reward: 20, completed: false });
                    if(type === 'shopItems') this.shopItems.push({ name: '×¤×™× ×•×§ ×—×“×©', cost: 50 });
                    if(type === 'habits') this.habits.push({ name: '×”×¨×’×œ ×—×“×©', done: false });
                },

                deleteItem(type, index) {
                    if(confirm('×œ××—×•×§ ××ª ×–×”?')) {
                        this[type].splice(index, 1);
                    }
                },
                
                resetHabits() {
                    if(confirm('×œ××¤×¡ ××ª ×›×œ ×”×”×¨×’×œ×™× ×œ×™×•× ×—×“×©?')) {
                        this.habits.forEach(h => h.done = false);
                    }
                }
            }
        }
    </script>
</body>
</html>
